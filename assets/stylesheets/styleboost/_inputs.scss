@use "styleboost/level";
@use "styleboost/utilities/functions";

@layer defaults {
	$bg: functions.themePropertyVar('color', 'bg', 'form');
	$bg-text: functions.themePropertyVar('color', 'bg-text', 'form');
	//$bg-text-rgb: functions.themePropertyVar('color', 'bg-text-rgb', 'form');

	$accent: functions.themePropertyVar('color', 'accent', 'form');
	$accent_rgb: functions.themePropertyVar('color', 'accent-rgb', 'form');
	$emphasis: functions.themePropertyVar('color', 'emphasis', 'form');
	$emphasis_rgb: functions.themePropertyVar('color', 'emphasis-rgb', 'form');

	textarea,
	select,
	input {
		--cp-border-color: rgba(#{$accent_rgb}, 0.6);
		--cp-color-placeholder: #{$bg-text};

		accent-color: var(--color-theme-fill);
		background-color: #{$bg};
		color: #{$bg-text};
		border: 1px solid var(--cp-border-color);

		appearance: none;
		align-items: center;
		border-radius: .375em;
		box-shadow: none;
		display: inline-flex;
		font-size: 1rem;
		height: 2.5em;
		justify-content: flex-start;
		line-height: 1.5;
		padding-bottom: calc(.5em - 1px);
		padding-left: calc(.75em - 1px);
		padding-right: calc(.75em - 1px);
		padding-top: calc(.5em - 1px);
		position: relative;
		vertical-align: top;

		&:hover {
			--cp-border-color: rgba(#{$emphasis_rgb}, 0.6);
		}

		&:active,
		&:focus {
			outline: 0;
			--cp-border-color: rgba(#{$emphasis_rgb}, 1);
			box-shadow: 0 0 0 .125em rgba(#{$emphasis_rgb}, 0.25);
		}
	}

	.control {
		position: relative;
		text-align: inherit;

		&:has(> .prefix) {
			input {
				padding-left: 2.5em;
			}
		}

		&:has(> .suffix) {
			input {
				padding-right: 2.5em;
			}
		}

		> .prefix,
		> .suffix {
			height: 2.5em;
			width: 2.5em;
		}

		> .prefix {
			left: 0;
		}

		> .suffix {
			right: 0;
		}

		input {
			width: 100%;
			max-width: 100%;
		}
	}

	input::placeholder,
	.control > .prefix,
	.control > .suffix {
		color: var(--cp-color-placeholder);
		opacity: 0.6;
	}

	label {
		display: inline-block;

		&:has(input, textarea, select) {
			margin-bottom: .5em;

			> * {
				display: block;
			}
		}
	}
}

.control {
	> .prefix,
	> .suffix {
		position: absolute;
		top: 0;
		z-index: 4;
		pointer-events: none;
	}
}